function isAPIRequest(url){var apiPaths=[betMobile.APIUrl];for(var i in apiPaths)if(_.includes(url,apiPaths[i]))return!0;return!1}$(document).ajaxSend(function(event,xhr,settings){isAPIRequest(settings.url)&&xhr.setRequestHeader("SubPlatformId",siteCookie.getCookie("spfid_mob"));var lang=window.User.lang;"zh-my"==lang&&(lang="zh-cn"),xhr.setRequestHeader("Token",siteCookie.getCookie("s")),xhr.setRequestHeader("LanguageCode",lang),/user\/wallet\/(\d+)\?(.*)/.test(settings.url)&&xhr.setRequestHeader("memberCode",bet_user.getMemberCode())}),$(document).ajaxComplete(function(event,request,settings){if(!_.isUndefined(request.responseJSON)&&isAPIRequest(settings.url)&&!_.isUndefined(request.responseJSON.ResponseCode))switch(request.responseJSON.ResponseCode){case-7:case-6:case-2:betMobile.Growl.shout(request.responseJSON.ResponseMessage,function(){bet_user.logout()})}}),window.betMobile.Validator=validator();var bet_validator=window.betMobile.Validator;function validator(){return{initiateValidator:function($formEl,setting){amplify.subscribe("validatorStatus",onValidatorStatus),_.forEach($("[data-date-box]"),function(item,index){var type=item.getAttribute("data-date-box");switch(type){case"time":$(item).datebox({mode:"timebox",showInitialValue:!0});break;case"payment":$(item).datebox({mode:"datebox",showInitialValue:!0,overrideDateFormat:"%m/%d/%Y",minDays:3,maxDays:3});break;case"dob":$(item).datebox({mode:"datebox",showInitialValue:!0,overrideDateFormat:"%m/%d/%Y",beforeToday:!0,minYear:18,maxYear:99,overrideSetDateButtonLabel:$.i18n("BUTTON_SET_DATE")}),$(item).datebox("setTheDate",new Date((new Date).getFullYear()-18,0,1));break;default:$(item).datebox({mode:"datebox",showInitialValue:!0,overrideDateFormat:"%m/%d/%Y"})}}),_.forEach($("[data-numeric]"),function(item,index){var numeric=item.getAttribute("data-numeric");_.isEmpty(numeric)?$(item).autoNumeric("init",{aSep:""}):$(item).autoNumeric("init",{aSep:"",mDec:numeric})}),$($formEl).validator({custom:{require:function($el){return $el.parent("div").removeClass("has-error"),$el.parent("div").children("span.help-block").remove(),$el.parent("div.form-group").removeClass("has-error"),$el.parent("div.form-group").children("span.help-block").remove(),$el.parent("div").parent("div.form-group").removeClass("has-error"),$el.parent("div").parent("div.form-group").children("span.help-block").remove(),!!_.isEmpty($el.val())&&($el.parent("div.form-group .input-group").length>0?($el.parent("div").parent("div.form-group").addClass("has-error"),$el.parent("div").parent("div.form-group").append('<span class="help-block">'+$.i18n("RequiredField")+"</span>")):($el.parent("div").append('<span class="help-block">'+$.i18n("RequiredField")+"</span>"),0==$el.parent("div.form-group").length?$el.parent("div").addClass("has-error"):$el.parent("div.form-group").addClass("has-error")),!0)},selectequals:function($el){$el.parent("div").removeClass("has-error"),$el.parent("div").children("span.help-block").remove(),$el.parent("div.form-group").removeClass("has-error"),$el.parent("div.form-group").children("span.help-block").remove();var matchValue=$el.data("selectequals");return $el.val()==matchValue&&($el.parent("div").append('<span class="help-block">'+$.i18n("RequiredField")+"</span>"),0==$el.parent("div.form-group").length?$el.parent("div").addClass("has-error"):$el.parent("div.form-group").addClass("has-error"),!0)},confirmvalue:function($el){if($el.parent("div").removeClass("has-error"),$el.parent("div").children("span.help-block").remove(),$el.parent("div.form-group").removeClass("has-error"),$el.parent("div.form-group").children("span.help-block").remove(),_.isEmpty($el.val())){if($el.context.required)return $el.parent("div").append('<span class="help-block">'+$.i18n("RequiredField")+"</span>"),$el.parent("div.form-group").addClass("has-error"),!0}else{var matchValue=$('[id$="'+$el.data("confirmvalue")+'"]').val();if($el.val()!=matchValue)return $el.parent("div").append('<span class="help-block">'+$.i18n("ConfirmField")+"</span>"),$el.parent("div.form-group").addClass("has-error"),!0}return!1},confirmrange:function($el){$el.parent("div.form-group").removeClass("has-error"),$el.parent("div.form-group").children("span.help-block").remove();var matchValue=$el.data("confirmrange").split("|");if(_.isEmpty($el.val())){if($el.context.required)return $el.parent("div").append('<span class="help-block">'+$.i18n("RequiredField")+"</span>"),$el.parent("div.form-group").addClass("has-error"),!0}else if(!_.inRange($el.val(),matchValue[0],matchValue[1])){if(parseFloat($el.val())<parseFloat(matchValue[0]))return $el.parent("div").append('<span class="help-block">'+$.i18n("Pay_AmountMinLimit")+"</span>"),$el.parent("div.form-group").addClass("has-error"),!0;if(parseFloat($el.val())>parseFloat(matchValue[1]))return $el.parent("div").append('<span class="help-block">'+$.i18n("Pay_AmountMaxLimit")+"</span>"),$el.parent("div.form-group").addClass("has-error"),!0}return!1},paylimit:function($el){if($el.parent("div.form-group").children("span.help-block").remove(),$el.parent(".form-group").removeClass("has-error"),!_.isEmpty($el)){var elValue=stringToNumber($el.val());if(_.isNaN(elValue)||elValue<setting.MinAmount)return $el.parent("div").append('<span class="help-block">'+$.i18n("Pay_AmountMinLimit")+"</span>"),!0;if(elValue>setting.MaxAmount)return $el.parent("div").append('<span class="help-block">'+$.i18n("Pay_AmountMaxLimit")+"</span>"),!0;if(setting.TotalAllowed!=$.i18n("Pay_Unlimited")&&elValue>parseFloat(_.replace(setting.TotalAllowed,/,/g,""))&&parseFloat(_.replace(setting.TotalAllowed,/,/g,""))>0)return $el.parent("div").append('<span class="help-block">'+$.i18n("Pay_TotalAllowedExceeded")+"</span>"),!0}return!1},balance:function($el){$el.parent("div.form-group").removeClass("has-error"),$el.parent("div.form-group").children("span.help-block").remove();var matchValue=$el.data("balance");return $("option:selected",$el).attr("balance")<=matchValue&&($el.parent("div").append('<span class="help-block">'+$.i18n("Pay_ErrInsufficientBalance")+"</span>"),!0)},maxlength:function($el){$el.parent("div.form-group").removeClass("has-error");var maxlength=$el.data("maxlength");return!_.isEmpty($el.val())&&$el.val().length>maxlength&&($el.parent("div.form-group").addClass("has-error"),!0)}}}),$($formEl).validator("update").validator()},disableSubmitButton:function(selector){setTimeout(function(){$(selector).prop("disabled",!0)},0)},enableSubmitButton:function(selector){setTimeout(function(){$(selector).prop("disabled",!1)},0)}};function onValidatorStatus(data){data}}function NotAllowDecimal(e){var key=e.keyCode;if($.browser.mozilla&&(key=e.which),0!=key&&8!=key){var regex=new RegExp("^[0-9]+$"),code=String.fromCharCode(key);if(!regex.test(code))return!1}}function CheckWholeNumber(element){return element.val().length>0&&(element.val().indexOf(".")>=0?(element.parent("div.ui-input-text").attr("style","border-bottom: 2px solid red !important"),!1):(element.parent("div.ui-input-text").removeAttr("style"),!0))}function ValidatePositiveDecimal(ctrl,e,cur){var allowDecimal;switch(void 0===cur&&(cur=""),cur){case"JPY":allowDecimal=!1;break;default:allowDecimal=!0}var key=e.keyCode;if($.browser.mozilla&&(key=e.which),0!=key&&8!=key)if(46==key){if(!allowDecimal)return!1;var code=String.fromCharCode(key);if(ctrl.value.indexOf(code)>=0)return!1}else{if(key<48||key>57)return!1;var num=parseFloat($(ctrl).val()+String.fromCharCode(key));if(num/num.toFixed(2)!=1)return!1}}function PositiveOneDecimalValidation(value,element){if(isNaN(value)||value<=0)return!1;var numArr=value.split(".");return!(numArr.length>1&&numArr[1].length>1)}function TwoDecimalAndroid(ctrl,event){var $this=ctrl;46==event.which&&-1==$this.val().indexOf(".")||!(event.which<48||event.which>57)||0==event.which||8==event.which||event.preventDefault();var text=$this.val();46==event.which&&-1==text.indexOf(".")&&setTimeout(function(){$this.val().substring($this.val().indexOf(".")).length>3&&$this.val($this.val().substring(0,$this.val().indexOf(".")+3))},1),-1!=text.indexOf(".")&&text.substring(text.indexOf(".")).length>2&&0!=event.which&&8!=event.which&&$this[0].selectionStart>=text.length-2&&event.preventDefault()}function getQueryStringValue(key){return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(key).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function getDomainName(){return location.hostname.split(".").slice(-2).join(".")}function generateStorageKey(module){var keyList=[];switch(keyList.push(getDomainName()),_.isEmpty(bet_cookies.getCookie("s"))||keyList.push(bet_cookies.getCookie("s")),_.isEmpty(bet_cookies.getCookie("language"))||keyList.push(bet_cookies.getCookie("language")),!0){case bet_isMobile.iOS():keyList.push("ios");break;case bet_isMobile.Android():default:keyList.push("other")}return _.join(keyList,"_").replace(/-/g,"").hashCode()+"_"+module}function formatDateTime(dateTime){return(1==(dateTime.getMonth()+1).toString().length?"0"+(dateTime.getMonth()+1).toString():(dateTime.getMonth()+1).toString())+"/"+(1==dateTime.getDate().toString().length?"0"+dateTime.getDate().toString():dateTime.getDate().toString())+"/"+dateTime.getFullYear()+" "+dateTime.getHours()+":"+dateTime.getMinutes()+":"+dateTime.getSeconds()}function getDateWithFormat(){var dtDate=new Date,yyyy=dtDate.getFullYear().toString(),mm=(dtDate.getMonth()+1).toString(),dd=dtDate.getDate().toString(),hh=dtDate.getHours()>12?dtDate.getHours()-12:dtDate.getHours(),day=yyyy+"/"+(2==mm.length?mm:"0"+mm)+"/"+(2==dd.length?dd:"0"+dd),tme=(2==hh.length?hh:"0"+hh)+":"+("0"+dtDate.getMinutes()).slice(-2)+":"+("0"+dtDate.getSeconds()).slice(-2),ampm=dtDate.getHours()>12?"PM":"AM";return day.toString()+" "+tme.toString()+" "+ampm.toString()}function addMonths(date,months){return date.setMonth(date.getMonth()+months),date}function addHours(date,hours){return date.setMonth(date.getHours()+hours),date}function stringToNumber(value){return parseFloat(_.replace(value,/,/g,""))}function bet_launchDownload(url,target,callback){if(_.isEmpty(target)||"_self"==target||"_notify"==target)top.location.href=url,"_notify"==target&&betMobile.Growl.shout($.i18n("DOWNLOADS_NOTIFY"),callback);else{if(0==$("iframe#"+target).length){var iframeLoader=$("<iframe />").attr("style","display:none").attr("src","about:blank").attr("id",target).attr("name",target);$("body").append(iframeLoader)}if("_blank"==target)if(bet_native.hasWrapper())try{bet_native.downloadStart(url)}catch(e){console.log(e.message)}else window.open(url,target);else window.open(url,target);betMobile.Growl.shout($.i18n("DOWNLOADS_NOTIFY"),callback)}}function bet_send(resource,method,data,success,complete){var selector="";_.isEmpty(data)||_.isEmpty(data.selector)||(selector=_.clone(data.selector),delete data.selector);var url=betMobile.APIUrl+resource;$.ajax({type:method,url:url,data:data,cache:!1,beforeSend:function(){amplify.publish("startLoadItem",{selector:selector})},success:success,error:function(){console.log("Error connecting to api "+url)},complete:function(){_.isFunction(complete)&&complete(),amplify.publish("stopLoadItem",{selector:selector})}})}function bet_local_send(resource,method,data,success,complete){var selector="";_.isEmpty(data)||_.isEmpty(data.selector)||(selector=_.clone(data.selector),delete data.selector);var url=resource,queryData={type:method,url:url,data:data,beforeSend:function(){amplify.publish("startLoadItem",{selector:selector})},success:success,cache:!1,error:function(){console.log("Error connecting to api "+url)},complete:function(){_.isFunction(complete)&&complete(),amplify.publish("stopLoadItem",{selector:selector})}};_.isEmpty(data.dataType)||(queryData.dataType=data.dataType),$.ajax(queryData)}$(document).ready(function(){var controller=new slidebars;controller.init(),amplify.subscribe("open-sidebar",function(){controller.toggle("right-sidebar"),amplify.publish("init-sidebar")}),$(".open-right-sidebar").on("click",function(event){event.stopPropagation(),event.preventDefault(),amplify.publish("open-sidebar")}),$("#nav-btn").on("click",function(event){event.stopPropagation(),event.preventDefault(),controller.toggle("side-nav"),$(".canvas").removeClass("expanded"),$(".side-nav").removeClass("overflow-shown"),$(".nav-category-items").removeClass("nav-category-items-shown")}),$(controller.events).on("opening",function(event){$("html").addClass("sidebar-open")}),$(controller.events).on("closing",function(event){$("html").removeClass("sidebar-open")});var canvas=document.getElementById("canvas"),isLoginPage=_.includes(location.pathname,_constants.LOGIN_URL);if(_constants.SWIPE.isEnabled&&!_.isNull(canvas)&&!bet_native.hasWrapper()&&"1"!=bet_cookies.getCookie("isNative")){isLoginPage||Hammer(canvas).on("swipeleft",function(){$("html").hasClass("sidebar-open")?controller.close():(controller.open("right-sidebar"),amplify.publish("init-sidebar"))});canvas=document.getElementById("canvas");Hammer(canvas).on("swiperight",function(){$("html").hasClass("sidebar-open")?controller.close():controller.open("side-nav")})}$(".side-nav-items li a").on("click",function(event){$(this).parent().hasClass("nav-category")?(event.stopPropagation(),event.preventDefault(),$(".canvas").addClass("expanded"),$(".side-nav").addClass("overflow-shown"),$(".nav-category-items").removeClass("nav-category-items-shown"),$(this).parent().find(".nav-category-items").addClass("nav-category-items-shown"),$(".side-nav").stop().animate({scrollTop:0},500,"swing")):(controller.close("side-nav"),$(".canvas").removeClass("expanded"),$(".side-nav").removeClass("overflow-shown"))}),$(".nav-category-items a").on("click",function(){controller.close("side-nav"),$(".canvas").removeClass("expanded"),$(".side-nav").removeClass("overflow-shown")}),$(".canvas").on("click",function(){controller.close("side-nav"),controller.close("right-sidebar"),$(".canvas").removeClass("expanded"),$(".side-nav").removeClass("overflow-shown")});var useragent=document.documentElement;useragent.setAttribute("data-useragent",navigator.userAgent),useragent.setAttribute("data-platform",navigator.platform),useragent.className+="ontouchstart"in window||"onmsgesturechange"in window?" touch":""}),String.prototype.hashCode=function(){var i,hash=0;if(0===this.length)return hash;for(i=0;i<this.length;i++)hash=(hash<<5)-hash+this.charCodeAt(i),hash|=0;return hash};var bet_isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return bet_isMobile.Android()||bet_isMobile.BlackBerry()||bet_isMobile.iOS()||bet_isMobile.Opera()||bet_isMobile.Windows()}},bet_queryString=function(){var hash,vars=[];if(-1==window.location.href.indexOf("?"))return vars;for(var hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<hashes.length;i++)hash=hashes[i].split("="),_.isEmpty(hashes[i])||(vars.push(hash[0]),vars[hash[0]]=decodeURIComponent(hash[1].replace(/\+/g,"%20")));return vars};function DataRegex(obj){if($(obj).attr("data-regex")){var match=new RegExp($(obj).attr("data-regex")).exec(obj.value);obj.value=match?match[1]:""}}function isBase64(token){return new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$").test(token)}function bet_getCurrencyByLanguage(lang){try{return bet_languages[lang].currency}catch(e){return""}}function bet_getShortLanguage(lang){try{return bet_languages[lang].short}catch(e){return"en"}}function bet_animateTitle(){var box=$(".header-title").outerWidth(),title=$(".header-title-text").outerWidth(),total=title-box;box<title&&($(".header-title").addClass("header-title-left"),$(".header-title-text").addClass("title-move"),setInterval(function(){$(".title-move").delay(5e3).animate({right:total+"px"},5e3).delay(5e3).animate({right:"0"},5e3)},5e3))}function replaceTokenUrl(response){if(!_constants.REPLACE_TOKEN)return response;var tokenList=["ExternalToken","st","token","s","QFToken"];return _.forEach(response,function(url){_.isEmpty(url.ImageInfo)||_.forEach(url.ImageInfo.Links,function(link){_.isEmpty(link.Link)||_.forEach(tokenList,function(param){var session=getParameterByName(param,link.Link);_.isEmpty(session)||(link.Link=_.replace(link.Link,session,bet_cookies.getCookie("s")))})})}),response}function replaceSlotsToken(url){if(!_constants.REPLACE_TOKEN)return url;var guidTest=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return _.forEach(["s","ticket","authToken","token","session","key","sessionToken","tempToken"],function(param){var session=getParameterByName(param,url);_.isEmpty(session)||guidTest.test(session)&&(url=_.replace(url,session,bet_cookies.getCookie("s")))}),url}function replaceDailyslotsUrl(data){return _.isEmpty(data.ResponseData)||_.isEmpty(data.ResponseData.promoList)||_.forEach(data.ResponseData.promoList,function(item){try{_.isEmpty(item.game.details)||(item.game.details.RealUrl=replaceSlotsToken(item.game.details.RealUrl),item.game.details.FunUrl=replaceSlotsToken(item.game.details.FunUrl))}catch(e){console.log(e.message)}}),data}function getParameterByName(name,url){url||(url=window.location.href),name=name.replace(/[\[\]]/g,"\\$&");var results=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)").exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null}window.bet_languages={},bet_languages["en-us"]={short:"en",currency:"USD"},bet_languages["id-id"]={short:"id",currency:"IDR"},bet_languages["ja-jp"]={short:"jp",currency:"JPY"},bet_languages["km-kh"]={short:"km",currency:"KHR"},bet_languages["ko-kr"]={short:"kr",currency:"KRW"},bet_languages["th-th"]={short:"th",currency:"THB"},bet_languages["vi-vn"]={short:"vn",currency:"VND"},bet_languages["zh-my"]={short:"cn",currency:"USD"},bet_languages["zh-cn"]={short:"cn",currency:"RMB"};var bet_user=UserSvc();function UserSvc(){var user={info:{},init:function(){var _self=this;_self.isLoggedIn()&&(_self.checkSession(),_self.get(function(){})),amplify.subscribe("wallet-update",function(data){if(0==data.Id){var main=data;if(!_.isEmpty(main)){var userData=_self.get();userData.Balance=_.clone(main),_self.set(userData)}}})},set:function(userData){(bet_native.hasWrapper()||_.isEmpty(bet_cookies.getCookie("s")))&&(bet_cookies.setCookie("s",userData.Token,1),bet_cookies.setCookie("g",userData.Token,1)),bet_cookies.setCookie("currencyCode",userData.CurrencyCode,1),!_.isEmpty(userData.Palazzo)&&isBase64(userData.Palazzo)&&bet_cookies.setCookie("palazzo",userData.Palazzo,1);var user=userData.Token+betMobile.Keys.userSettings;amplify.store(user,userData,{expires:864e5})},get:function(callback){var _self=this,user=bet_cookies.getCookie("s")+betMobile.Keys.userSettings,userData=amplify.store(user);if(_self.info=userData,!_.isEmpty(userData))return _.isFunction(callback)&&callback(userData),userData;_.isFunction(callback)&&(_.isEmpty(userData)?bet_send("/user/account","GET","",function(response){_.isEqual(response.ResponseCode,1)&&(_self.set(response.ResponseData),_self.info=response.ResponseData,callback(response.ResponseData))}):callback(userData))},logout:function(){var lang=bet_cookies.getCookie("language");amplify.clearStore(),bet_cookies.clearCookies(),window.location.href=_constants.DASHBOARD_URL+"?lang="+lang},isLoggedIn:function(){return!_.isEmpty(bet_cookies.getCookie("s"))},checkSession:function(){var _self=this,interval=0,throttle=1;setTimeout(function checkSession(){$.ajax({contentType:"application/json; charset=utf-8",url:"/_secure/AjaxHandlers/MemberSessionCheck.ashx?page="+location.pathname,responseType:"json",cache:!1,success:function(data){throttle=1,"1"!=data.code?void 0!==data.message?betMobile.Growl.shout(data.message,function(){_self.logout()}):_self.logout():(interval=_constants.SESSION_CHECK_INTERVAL>0?_constants.SESSION_CHECK_INTERVAL:1e4,setTimeout(checkSession,interval))},error:function(err){throttle++,setTimeout(checkSession,interval*throttle)}})},interval)},getMemberCode:function(){var userData=amplify.store(user);return _.isEmpty(userData)?bet_cookies.getCookie("s")==this.info.CurrentSessionId?this.info.MemberCode:(console.log("User info is not available"),""):userData.MemberCode}};return user}function loader(){return{items:{},init:function(){amplify.subscribe("startLoadItem",onStartLoadItem),amplify.subscribe("stopLoadItem",onStopLoadItem)},onStartLoadItem:onStartLoadItem,onStopLoadItem:onStopLoadItem,attachLoader:function(elem,key){"main"==key?elem.append($("<section />",{class:"css-loader-full"}).append($("<div />",{class:"css-loader-container"}).append($("<img />",{class:"css-loader-logo",alt:"Logo",src:"/_Static/images/v2/logo/logo-en.png"})).append("&nbsp;").append($("<div />",{class:"css-loader"}).append($("<div />")).append("&nbsp;").append($("<div />")).append("&nbsp;").append($("<div />")).append("&nbsp;")))):elem.width()<100?elem.append($("<div />",{class:"css-loader  css-loader-small"}).append($("<div />")).append("&nbsp;").append($("<div />")).append("&nbsp;").append($("<div />")).append("&nbsp;")):(elem.hasClass("css-loader-ready")||elem.addClass("css-loader-ready"),elem.append($("<div />",{class:"css-loader-center"}).append($("<div />",{class:"css-loader-container"}).append($("<div />",{class:"css-loader"}).append($("<div />")).append("&nbsp;").append($("<div />")).append("&nbsp;").append($("<div />")).append("&nbsp;")))))}};function onStartLoadItem(data){var key="main";_.isUndefined(data.selector)||_.isEmpty(data.selector)||(key=data.selector);var elem=$("body");"main"!=key&&(elem=elem.find("."+key)),_.isEmpty(elem)||(_.isEmpty(elem.find("div.css-loader"))&&betMobile.Loader.attachLoader(elem,key),_.isUndefined(betMobile.Loader.items[key])&&(betMobile.Loader.items[key]=[]),betMobile.Loader.items[key].push(data))}function onStopLoadItem(data){var key="main";_.isUndefined(data.selector)||_.isEmpty(data.selector)||(key=data.selector),_.isUndefined(betMobile.Loader.items[key])||(betMobile.Loader.items[key].pop(),0==betMobile.Loader.items[key].length&&("main"!=key?$("."+key).find("[class^='css-loader']").remove():$("section.css-loader-full").remove()))}}function Notification(){return{options:{hasButtons:!1,lang:"en",close:"x",ok:"OK"},init:function(){$("body").append('<div class="modal fade" id="betmodal" tabindex="-1" role="dialog" aria-labelledby="sample-modal1"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header mheader-notitle"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span class="icon icon-close"></span></button><div class="modal-title" id="ModalTitle"></div></div><div id="ModalMessage"></div></div></div></div>')},shout:function(msg,callback){var message=' <div class="modal-body"><p>'+msg+"</p></div>";$("#ModalMessage").html(message),$("#betmodal").modal("show"),!_.isUndefined(callback)&&_.isFunction(callback)&&$("#betmodal").on("hidden.bs.modal",callback)},notif:function(message,callback){var content=' <div class="modal-body"><p>'+message.Content+"</p></div>";$("#ModalMessage").html(content),$("#ModalTitle").html(message.Title),$("#betmodal").modal("show"),!_.isUndefined(callback)&&_.isFunction(callback)&&$("#betmodal").on("hidden.bs.modal",callback)},confirm:function(msg,yesCallback,noCallback){var message=' <div class="modal-body"><p>'+msg+'</p></div><div class="modal-footer"><button type="button" class="btn btn-primary" id="btnYes" data-i18n="BUTTON_YES"></button><button type="button" class="btn btn-default" data-dismiss="modal" data-i18n="BUTTON_NO">No</button></div>';$("#ModalMessage").html(message),$("#betmodal").modal("show"),$("#betmodal").i18n(),!_.isUndefined(yesCallback)&&_.isFunction(yesCallback)&&$("#btnYes").on("click",yesCallback),!_.isUndefined(noCallback)&&_.isFunction(noCallback)&&$("#betmodal").on("hidden.bs.modal",noCallback)},bulletedList:function(messages){var message="";if(_.isArray(messages)){message="<ul class='list-unstyled'>";for(var i=0;i<messages.length;i++)message=message+"<li>"+messages[i]+"</li>";return message+"</ul>"}return message},modal:null}}betMobile.Loader=loader(),window.betMobile.Growl=window._growl=Notification();var bet_templates=betMobile.Templates=Templates();function Templates(){var history_tpl_path="/_Static/v2/assets/js/modules/history",account_tpl_path="/_Static/v2/assets/js/modules/accounts",templateSettings=[{id:"History_DepositWithdraw",url:history_tpl_path+"/templates/depositWithdraw.html"},{id:"History_FundTransfer",url:history_tpl_path+"/templates/fundTransfer.html"},{id:"History_Adjustment",url:history_tpl_path+"/templates/adjustment.html"},{id:"History_PromoClaim",url:history_tpl_path+"/templates/promoClaim.html"},{id:"History_AdjustmentModal",url:history_tpl_path+"/templates/adjustmentModal.html"},{id:"History_DepositWithdrawModal",url:history_tpl_path+"/templates/depositWithdrawModal.html"},{id:"History_FundTransferModal",url:history_tpl_path+"/templates/fundTransferModal.html"},{id:"MainWallet",url:"/_Static/v2/templates/wallets/mainwallet.html"},{id:"WalletGroup",url:"/_Static/v2/templates/wallets/walletgroup.html"},{id:"WalletBallance",url:"/_Static/v2/templates/wallets/walletbalance.html"},{id:"User_Login",url:account_tpl_path+"/templates/login.html"},{id:"User_Login_VIP",url:account_tpl_path+"/templates/login_vip.html"},{id:"User_Login_Palazzo",url:account_tpl_path+"/templates/login_palazzo.html"},{id:"PaymentOptions_BankAccount",url:_constants.ASSETS_URL+"/assets/js/modules/accounts/templates/bankaccountModal.html"},{id:"PaymentOptions_Wechat",url:_constants.ASSETS_URL+"/assets/js/modules/accounts/templates/wechatModal.html"},{id:"PaymentOptions_Alipay",url:_constants.ASSETS_URL+"/assets/js/modules/accounts/templates/alipayModal.html"},{id:"PaymentOptions_QQ",url:_constants.ASSETS_URL+"/assets/js/modules/accounts/templates/qqModal.html"},{id:"PaymentOptions_GoPay",url:_constants.ASSETS_URL+"/assets/js/modules/accounts/templates/gopayModal.html"}];return{init:function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/\{%([\s\S]+?)%\}/g,escape:/\{%-([\s\S]+?)%\}/g},_.templateSettings.variable="tplData"},items:{},apply:function(template,callback){var _self=this;"object"!=typeof template&&(template=_.find(templateSettings,function(tpl){return tpl.id==template})),void 0!==template.id?_.isUndefined(_self.items[template.id])?$.get(template.url,function(template){_self.items[template.id]=template,callback(_self.items[template.id])},"html"):callback(_self.items[template.id]):console.log("unable to fetch template")}}}function betPage(cookieSvc,userSvc){this.isPublic=!0,this.name="Bet",this.init=function(){if(_.isEmpty(location.protocol.match(/^https/)),userSvc.init(),this.checkQueryParams(),!this.isPublic&&!userSvc.isLoggedIn()){var redirUrl=_.isEmpty(cookieSvc.getCookie("IsApp"))?_constants.LOGIN_URL:_constants.FUNDS_URL;redirUrl+="?redirect="+encodeURI(location.pathname),location.href=redirUrl}},this.isNative=function(){return!_.isEmpty(cookieSvc.getCookie("isNative"))},this.checkQueryParams=function(){var isApp,isNative,spfid,affiliateId,referId,lang;if(!_.isEmpty(isApp=getQueryStringValue("isApp"))){var expiry=1==isApp?1:-1;cookieSvc.setCookie("IsApp",isApp,expiry)}if(!_.isEmpty(isNative=getQueryStringValue("isNative"))){expiry=1==isNative?1:-1;cookieSvc.setCookie("isNative",isNative,expiry)}if(_.isEmpty(spfid=getQueryStringValue("spfid"))?_.isEmpty(cookieSvc.getCookie("spfid_mob"))&&cookieSvc.setCookie("spfid_mob","22",1):cookieSvc.setCookie("spfid_mob",spfid,1),_.isEmpty(affiliateId=getQueryStringValue("AffiliateId"))||cookieSvc.setCookie("AffiliateId",affiliateId,1),_.isEmpty(referId=getQueryStringValue("ReferralId"))||cookieSvc.setCookie("ReferralId",referId,1),lang=getQueryStringValue("lang"),_.isEmpty(lang)&&(lang=getQueryStringValue("language")),!_.isEmpty(lang)&&lang!=cookieSvc.getCookie("language")){cookieSvc.setCookie("language",lang,1);var urlRedirect=this.removeQueryParam("lang",location.href);urlRedirect=this.removeQueryParam("language",urlRedirect),location.href=urlRedirect}},this.removeQueryParam=function(key,sourceURL){var rtn=sourceURL.split("?")[0],params_arr=[],queryString=-1!==sourceURL.indexOf("?")?sourceURL.split("?")[1]:"";if(""!==queryString){for(var i=(params_arr=queryString.split("&")).length-1;i>=0;i-=1)params_arr[i].split("=")[0]===key&&params_arr.splice(i,1);rtn=rtn+"?"+params_arr.join("&")}return rtn},this.setHeader=function(headerText){$("h1.header-title").html(headerText)}}bet_templates.init(),window.bet_page=betPage;var bet_native=betNative();function betNative(){return{init:function(deviceId){!0},openLiveCasino:function(){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):window.webkit.messageHandlers.Native.postMessage(JSON.stringify({action:"onOpenLiveCasino"}));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.openLiveCasino()}}catch(e){console.log(e.message)}},openSlidingMenu:function(){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):window.webkit.messageHandlers.Native.postMessage(JSON.stringify({action:"onOpenSlidingMenu"}));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.openSlidingMenu()}}catch(e){console.log(e.message)}},openDeposit:function(){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):window.webkit.messageHandlers.Native.postMessage(JSON.stringify({action:"onOpenDeposit"}));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.openDeposit()}}catch(e){console.log(e.message)}},openLiveChat:function(url){if(!this.hasWrapper())return void(_.isEmpty(url)||window.open(url,"ChatWindow"));try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):window.webkit.messageHandlers.Native.postMessage(JSON.stringify({action:"onOpenLiveChat"}));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.openLiveChat()}}catch(e){console.log(e.message),_.isEmpty(url)||window.open(url,"ChatWindow")}},slotGameClosed:function(){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):window.webkit.messageHandlers.Native.postMessage(JSON.stringify({action:"onSlotGameClosed"}));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.onSlotGameClosed()}}catch(e){console.log(e.message)}},slotGameOpened:function(provider,gameId){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):var data={action:"onSlotGameOpened",provider:provider,gameId:gameId};window.webkit.messageHandlers.Native.postMessage(JSON.stringify(data));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.onSlotGameOpened(provider,gameId)}}catch(e){console.log(e.message)}},hasWrapper:function(){return"undefined"!=typeof Native||void 0!==window.webkit&&void 0!==window.webkit.messageHandlers.Native},downloadStart:function(url){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):var data={action:"onDownloadStart",url:url};window.webkit.messageHandlers.Native.postMessage(JSON.stringify(data));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.onDownloadStart(url)}}catch(e){console.log(e.message)}},sessionExpired:function(){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):window.webkit.messageHandlers.Native.postMessage(JSON.stringify({action:"onSessionExpired"}));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.onSessionExpired()}}catch(e){console.log(e.message)}},backToNativeHomePage:function(){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):window.webkit.messageHandlers.Native.postMessage(JSON.stringify({action:"onBackNativeHomePage"}));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.onBackNativeHomePage()}}catch(e){console.log(e.message)}},backPressed:function(url){if(!this.hasWrapper())return;try{switch(!0){case!_.isEmpty(bet_isMobile.iOS()):window.webkit.messageHandlers.Native.postMessage(JSON.stringify({action:"onBackPressed"}));break;case!_.isEmpty(bet_isMobile.Android()):default:Native.onBackPressed()}}catch(e){location.href=url,console.log(e.message)}}}}function piwikManager(){var goals={playNow:2,tryNow:1,registerSuccess:1,signupSuccess:1,iosDownload:2,androidDownload:3},memberId="";function getInstance(){if(_.isEqual(betMobile.PiwikConfig.isEnable,!0))return"undefined"!=typeof Piwik?Piwik.getAsyncTracker():{}}function trackGoal(goal){if(_.isEqual(betMobile.PiwikConfig.isEnable,!0)){var piwik=getInstance();"object"==typeof piwik&&"function"==typeof piwik.trackGoal?piwik.trackGoal(goal):_paq.push(["trackGoal",goal])}}function setCustomDimension(useCase,dimensions){if(_.isEqual(betMobile.PiwikConfig.isEnable,!0)){var piwik=getInstance(),async="object"==typeof piwik&&"function"==typeof piwik.setCustomDimension||!!_.isUndefined(_paq)&&void 0;switch(useCase){case"gpiSlotClick":async?piwik.trackLink(dimensions.url,"link",{dimension4:dimensions.gameType,dimension5:dimensions.gameName,dimension6:dimensions.club,dimension7:dimensions.playType}):async||"undefined"==typeof aync||_paq.push(["trackLink",dimensions.url,"link",{dimension4:dimensions.gameType,dimension5:dimensions.gameName,dimension6:dimensions.club,dimension7:dimensions.playType}]);break;default:console.log("...skipping Dimension request")}}}function _reportGpiSlotClick(obj){if(_.isEqual(betMobile.PiwikConfig.isEnable,!0)){var a=document.createElement("a");a.href=obj.url,obj.gameName=a.pathname.replace(/\//g,""),obj.gameType="Slot",setCustomDimension("gpiSlotClick",obj)}}return{trackPlayNow:function(obj){_.isEqual(betMobile.PiwikConfig.isEnable,!0)&&(trackGoal(goals.playNow),_.isEmpty(obj)||"string"==typeof obj.club&&"string"==typeof obj.url&&(obj.playType="Real",_reportGpiSlotClick(obj)))},trackTryNow:function(obj){_.isEqual(betMobile.PiwikConfig.isEnable,!0)&&(trackGoal(goals.tryNow),_.isEmpty(obj)||"string"==typeof obj.club&&"string"==typeof obj.url&&(obj.playType="Fun",_reportGpiSlotClick(obj)))},trackEvent:function(event){if(_.isEqual(betMobile.PiwikConfig.isEnable,!0)){var piwik=getInstance();"object"==typeof piwik&&"function"==typeof piwik.trackEvent?piwik.trackEvent(event.category,event.action,event.name):_paq.push(["trackEvent",event.category,event.action,event.name])}},trackSignup:function(){_.isEqual(betMobile.PiwikConfig.isEnable,!0)&&trackGoal(goals.registerSuccess)},setUserId:function(id){if(_.isEqual(betMobile.PiwikConfig.isEnable,!0)){memberId=id;var piwik=getInstance();"object"==typeof piwik&&"function"==typeof piwik.setUserId?piwik.setUserId(id):_.isUndefined(_paq)||_paq.push(["setUserId",id])}},setDeviceId:function(obj){if(_.isEqual(betMobile.PiwikConfig.isEnable,!0)&&!_.isEmpty(memberId)){var piwik=getInstance();"object"==typeof piwik&&"function"==typeof piwik.setCustomVariable?piwik.setCustomVariable(obj.index,obj.name,obj.value,obj.scope):_.isUndefined(_paq)||_paq.push(["setCustomVariable",obj.index,obj.name,obj.value,obj.scope])}},setGoals:function(configGoals){_.isEqual(betMobile.PiwikConfig.isEnable,!0)&&(_.isEmpty(configGoals)||(goals=configGoals))},setDomain:function(){if(_.isEqual(betMobile.PiwikConfig.isEnable,!0)){var hosts=location.hostname,piwik=getInstance();"object"==typeof piwik&&"function"==typeof piwik.setDomains?piwik.setDomains(hosts):_.isUndefined(_paq)||_paq.push(["setDomains",hosts])}},setCustomDimension:setCustomDimension,trackSignupSuccess:function(){trackGoal(goals.signupSuccess)},trackIosDownload:function(){trackGoal(goals.iosDownload)},trackAndroidDownload:function(){trackGoal(goals.androidDownload)}}}function translate(){this.items={},this.expiry=_constants.STORAGE_EXPIRATION.ContentsExpiration,this.hasi18n=!_.isUndefined($.i18n),this.storageKey=generateStorageKey("language"),this.init=function(){var _language=bet_cookies.getCookie("language"),contents=amplify.store(this.storageKey);_.isEmpty(contents)||contents.language!=_language?this.fetch(_language):(this.items=contents,this.hasi18n&&($.i18n().load(contents,_language),$("body").i18n()),$(document).ready(function(){amplify.publish("contentsLoaded",{isFull:!0})}))},this.fetch=function(lang){var _self=this,endpoint="/"+lang+"/translations",url=betMobile.APIUrl+endpoint,headers={Token:window.User.token,LanguageCode:lang};$.ajax({type:"GET",beforeSend:function(){},url:url,data:{},cache:!1,headers:headers,success:function(response){if(!_.isUndefined(response.ResponseData)){var settings=_.clone(window.User.storageExpiration);settings.expires=_self.expiry;var contents=_.assign(response.ResponseData.Contents,response.ResponseData.Messages);contents.language=bet_cookies.getCookie("language"),amplify.store(_self.storageKey,contents,settings),_self.items=contents,_self.hasi18n&&($.i18n().load(contents,lang),$("body").i18n()),amplify.publish("contentsLoaded",{isFull:!0}),amplify.publish("languagesLoaded",{languages:response.ResponseData.Languages})}},error:function(){console.log("unable to load contents")},complete:function(){}})},this.translate=function(key){return _.isEmpty(this.items[key])?_.isUndefined(_i18n_contents)||_.isUndefined(_i18n_contents[key])?key:_i18n_contents[key]:this.items[key]}}window.betMobile.PiwikManager=piwikManager(),betMobile.Translate=translate,window.betMobile.Products=Products();var bet_products=window.betMobile.Products;function Products(){var products={},device=bet_isMobile.iOS()?"ios":"other",expires={expires:6e5},consumer=bet_native.hasWrapper()?"native":"mobile";function displayPoker(data){var template=_.template($("script#pokerTemplate").html());$("#poker-placeholder").html(template({data:data})),$("#poker-placeholder").i18n(),amplify.publish("pokerUrl",data)}function displayCasino(data){var template=_.template($("script#CasinoTemplate").html());$("#casino-placeholder").html(template({data:data})),$("#casino-placeholder").i18n(),amplify.publish("casinoUrl",data)}function displayLottery(data){var template=_.template($("script#template").html());$("#lottery-placeholder").html(template({data:data})),$("#lottery-placeholder").i18n(),amplify.publish("lotteryUrl",data)}function displayP2P(data){var template=_.template($("script#p2pTemplate").html());$("#p2p-placeholder").html(template({data:data})),$("#p2p-placeholder").i18n()}function displayGames(data){var template=_.template($("script#fascinoTemplate").html());$("#fascino-placeholder").html(template({data:data})),$("#fascino-placeholder").i18n(),amplify.publish("gamesProductUrl",data)}function displaySports(data){var template=_.template($("script#SportsTemplate").html());$("#sports-placeholder").html(template({data:data})),$("#sports-placeholder").i18n(),amplify.publish("sportsUrl",data)}function displayVSports(data){var template=_.template($("script#vSportsTemplate").html());$("#vsports-placeholder").html(template({data:data})),$("#vsports-placeholder").i18n()}function displaySlots(data){amplify.publish("slotsProductUrl",data)}return void 0===generateStorageKey&&(generateStorageKey=function(key){return bet_cookies.getCookie("language")+"_"+key}),products.createEndPointUrl=function(product){return"/products/"+consumer+"/"+device+"/"+product},products.checkFreeRounds=function(){bet_send("/products/freerounds/gpi","GET",{cashier:_constants.FUNDS_URL,Lobby:_constants.SLOTS_BRAVADO_URL},function(response){amplify.publish("checkFreeRounds",response.ResponseData)})},products.poker=function(){var pokerKey=generateStorageKey("product_poker"),pokerData=amplify.store(pokerKey);_.isEmpty(pokerData)?bet_send(bet_products.createEndPointUrl("poker"),"GET","",function(response){amplify.store(pokerKey,response.ResponseData,expires),displayPoker(response.ResponseData)}):displayPoker(pokerData)},products.casino=function(){var casinoKey=generateStorageKey("product_casino"),casinoData=amplify.store(casinoKey);if(_.isEmpty(casinoData)){var data={cashier:"Funds.aspx",lobby:"Slots",configfile:"default",gamepass:bet_cookies.getCookie("palazzo")};bet_send(bet_products.createEndPointUrl("casino"),"GET",data,function(response){response.ResponseData=replaceTokenUrl(response.ResponseData),amplify.store(casinoKey,response.ResponseData,expires),displayCasino(response.ResponseData)})}else displayCasino(casinoData)},products.lottery=function(){var lotteryKey=generateStorageKey("product_lottery"),lotteryData=amplify.store(lotteryKey);_.isEmpty(lotteryData)?bet_send(bet_products.createEndPointUrl("lottery"),"GET","",function(response){response.ResponseData=replaceTokenUrl(response.ResponseData),amplify.store(lotteryKey,response.ResponseData,expires),displayLottery(response.ResponseData)}):displayLottery(lotteryData)},products.p2p=function(){var p2pKey=generateStorageKey("product_p2p"),p2pData=amplify.store(p2pKey);_.isEmpty(p2pData)?bet_send(bet_products.createEndPointUrl("p2p"),"GET","",function(response){amplify.store(p2pKey,response.ResponseData,expires),displayP2P(response.ResponseData)}):displayP2P(p2pData)},products.games=function(){var gamesKey=generateStorageKey("product_games"),gamesData=amplify.store(gamesKey);_.isEmpty(gamesData)?bet_send(bet_products.createEndPointUrl("games"),"GET","",function(response){response.ResponseData=replaceTokenUrl(response.ResponseData),amplify.store(gamesKey,response.ResponseData,expires),displayGames(response.ResponseData)}):displayGames(gamesData)},products.sports=function(){var sportsKey=generateStorageKey("product_sports"),sportsData=amplify.store(sportsKey);_.isEmpty(sportsData)?bet_send(bet_products.createEndPointUrl("sports"),"GET","",function(response){response.ResponseData=replaceTokenUrl(response.ResponseData),amplify.store(sportsKey,response.ResponseData,expires),displaySports(response.ResponseData)}):displaySports(sportsData)},products.vsports=function(){var vSportsKey=generateStorageKey("product_vsports"),vSportsData=amplify.store(vSportsKey);_.isEmpty(vSportsData)?bet_send(bet_products.createEndPointUrl("vsports"),"GET","",function(response){response.ResponseData=replaceTokenUrl(response.ResponseData),amplify.store(vSportsKey,response.ResponseData,expires),displayVSports(response.ResponseData)}):displayVSports(vSportsData)},products.slots=function(){var vSlotsKey=generateStorageKey("product_slots"),vSlotsData=amplify.store(vSlotsKey);_.isEmpty(vSlotsData)?bet_send(bet_products.createEndPointUrl("slots"),"GET","",function(response){response.ResponseData=replaceTokenUrl(response.ResponseData),amplify.store(vSlotsKey,response.ResponseData,expires),displaySlots(response.ResponseData)}):displaySlots(vSlotsData)},products.launcher=function(provider,gl,gu,gp){var gamelink=gl,languageCode="en";switch(provider){case"PT":switch(bet_cookies.getCookie("language")){case"ko-kr":languageCode="ko";break;case"th-th":languageCode="th";break;case"zh-cn":languageCode="zh-cn";break;default:languageCode="en"}gamelink="/palazzolauncher?gu="+gu.toUpperCase()+"&langCode="+languageCode+"&gp="+gp+"&game_link="+gl;break;default:gamelink=gl}return gamelink},products}var bet_menu=betMobile.Menu=Menu();function Menu(){var menu={init:function(){$("a.poker").bind("touch click",function(){$(".img_poker_iOS").attr("src",_constants.IMAGES_URL+"/Mobile-Poker-iOS.jpg"),$(".img_poker_Android").attr("src",_constants.IMAGES_URL+"/Mobile-Poker-Android.jpg")}),$("a.texas_mahjong").bind("touch click",function(){$(".img_texas_mahjong_iOS").attr("src",_constants.IMAGES_URL+"/Download/TexasMahjong-iOS.jpg"),$(".img_texas_mahjong_Android").attr("src",_constants.IMAGES_URL+"/Download/TexasMahjong-Android.jpg"),bet_isMobile.iOS()?$(".img_super_bull").attr("src",_constants.IMAGES_URL+"/Download/mobilesite-thumbnail-SuperBull-iOS.jpg"):$(".img_super_bull").attr("src",_constants.IMAGES_URL+"/Download/mobilesite-thumbnail-SuperBull-Android.jpg")}),$(".url_login").click(function(e){e.stopPropagation(),_.includes(location.pathname,_constants.LOGIN_URL)||amplify.publish("open-sidebar")}),$(".url_deposit").attr("href",_constants.DEPOSIT_URL),$(".url_transfer").attr("href",_constants.TRANSFER_URL),$(".url_withdraw").attr("href",_constants.WITHRAW_URL),$(".url_history").attr("href",_constants.HISTORY_URL),$(".url_upload").attr("href",_constants.UPLOAD_URL),$(".url_promo").attr("href",_constants.PROMO_URL),$(".url_texas_mahjong").attr("href",_constants.DOWNLOAD_TM_IOS_URL),$(".url_super_bull").attr("href",_constants.DOWNLOAD_SB_IOS_URL),$(".url_live_chat").attr("href",_constants.LIVECHAT_URL),$(".url_download").attr("href",_constants.DOWNLOAD_URL),_.isEqual(bet_cookies.getCookie("isNative"),"1")||($("a.sports").bind("touch click",function(){$("#sports-thumbnails").html().length<=0&&bet_products.sports()}),$("a.casino").bind("touch click",function(){$("#casino-thumbnails").html().length<=0&&bet_products.casino()}),$("a.slots").bind("touch click",function(){$("#slots-thumbnails").html().length<=0&&bet_products.slots()}),$("a.fishing").bind("touch click",function(){$("#fishing-thumbnails").html().length<=0&&bet_products.games()}),$("a.lottery").bind("touch click",function(){$("#lottery-thumbnails").html().length<=0&&bet_products.lottery()}),$("a.poker").bind("touch click",function(){$("#poker-thumbnails").html().length<=0&&bet_products.poker()})),$("a.logout").bind("touch click",function(){bet_user.logout()}),$(document).on("click",".download-ios",function(){betMobile.PiwikManager.trackIosDownload()}),$(document).on("click",".download-other",function(){betMobile.PiwikManager.trackAndroidDownload()})}},loginUrl=_constants.LOGIN_URL+"?redirect="+window.location.pathname;return amplify.subscribe("casinoUrl",function(data){var template=_.template($("script#CasinoSideMenuTemplate").html());$("#casino-thumbnails").html(template({data:data,loginUrl:loginUrl})),$("#casino-thumbnails").i18n()}),amplify.subscribe("lotteryUrl",function(data){var template=_.template($("script#LotterySideMenuTemplate").html());$("#lottery-thumbnails").html(template({data:data,loginUrl:loginUrl})),$("#lottery-thumbnails").i18n()}),amplify.subscribe("sportsUrl",function(data){var clubwImage,template=_.template($("script#SportsSideMenuTemplate").html());clubwImage=bet_isMobile.iOS()?_constants.IMAGES_URL+"/sports/bnr-club-iOS.jpg":_constants.IMAGES_URL+"/sports/bnr-club-Android.jpg",$("#sports-thumbnails").html(template({data:data,clubWImage:clubwImage,loginUrl:loginUrl,isLogin:!_.isEmpty(bet_cookies.getCookie("s"))})),$("#sports-thumbnails").i18n()}),amplify.subscribe("gamesProductUrl",function(data){var template=_.template($("script#GamesSideMenuTemplate").html());$("#fishing-thumbnails").html(template({data:data})),$("#fishing-thumbnails").i18n()}),amplify.subscribe("slotsProductUrl",function(data){var template=_.template($("script#SlotsSideMenuTemplate").html());$("#slots-thumbnails").html(template({data:data})),$("#slots-thumbnails").i18n()}),amplify.subscribe("pokerUrl",function(data){var template=_.template($("script#PokerSideMenuTemplate").html());$("#poker-thumbnails").html(template({data:data,loginUrl:loginUrl})),$("#poker-thumbnails").i18n()}),menu}window.betMobile.LanguageSelection=LanguageSelection();var bet_LanguageSelection=window.betMobile.LanguageSelection;function LanguageSelection(){var languages={};return languages.countryCode=bet_cookies.getCookie("CDNCountryCode"),languages.storageKey="languages-"+languages.countryCode,languages.init=function(data){var lang=bet_cookies.getCookie("language");this.setData(data),_.isEmpty(lang)?(bet_LanguageSelection.display(!1),$("#full-modal div.modal-header.close").hide(),$("#full-modal").modal("show")):bet_LanguageSelection.display(!0)},languages.setData=function(data){var lang=_.clone(data);"MY"==this.countryCode&&_.forOwn(lang,function(d,index){switch(d.LangCode){case"en-us":case"zh-cn":lang[index].ImageUrl="/_Static/Images/flags/my.jpg"}}),amplify.store(this.storageKey,lang,{expires:_constants.STORAGE_EXPIRATION.ContentsExpiration})},languages.display=function(hasClose,filter){var lang=amplify.store(this.storageKey);_.isEmpty(lang)?console.log("Empty language"):(_.isEmpty(filter)||(lang=bet_LanguageSelection.filter(lang,filter)),bet_LanguageSelection.setTemplate(lang,hasClose))},languages.setTemplate=function(data,hasClose){var langTemplate=_.template($("script#LanguageSelectionTemplate").html());$("#full-modal div.modal-content").html(langTemplate({data:data,hasCloseButton:hasClose,activeLang:bet_cookies.getCookie("language")})),$("#full-modal").i18n()},languages.select=function(langCode){_.isEmpty(langCode)||(bet_cookies.setCookie("language",langCode),window.location.reload())},languages.filter=function(langCollection,selected){return _.filter(langCollection,function(x){return _.includes(selected,x.LangCode)})},languages.show=function(){bet_LanguageSelection.display(!0),$("#full-modal div.modal-header.close").show(),$("#full-modal").modal("show")},languages.showSelected=function(langCode){bet_LanguageSelection.display(!0,langCode),$("#full-modal div.modal-header.close").show(),$("#full-modal").modal("show")},languages}amplify.subscribe("languagesLoaded",function(data){bet_LanguageSelection.init(data.languages)}),window.betMobile.announcement=announcement();var bet_announcement=window.betMobile.announcement;function announcement(){var obj={},announcementKey="announcement",expires={expires:18e5};return obj.init=function(){var _self=this;bet_cookies.getCookie("language");announcementKey=generateStorageKey("announcements"),_self.template=_.template($("script#AnnouncementTemplate").html()),_self.templatePop=_.template($("script#AnnouncementPopUpTemplate").html());var announcements=amplify.store(announcementKey);_.isEmpty(announcements)?bet_send("/user/announcement","GET","",function(response){var data=response.ResponseData;_.isEqual(response.ResponseCode,1)&&(amplify.store(announcementKey,data,expires),_self.display(data))},""):_self.display(announcements)},obj.display=function(data){$("#AnnouncementContainer").html(this.template({data:data})),$("#AnnouncementContainer").i18n(),$(".announcement-popup .well").prepend(this.templatePop({data:data.notification})),bet_cookies.getCookie("seen_announcement")==data.notification.id&&$("#btn-announcement small").hide()},obj.openAnnouncement=function(){bet_cookies.setCookie("seen_announcement",_.isUndefined($(".announcement-popup p"))?0:$(".announcement-popup p").attr("id")),$("#btn-announcement small").hide()},obj.viewAll=function(){$("#collapseAnnouncement").removeClass("in"),$("#announcement-modal").modal("show")},obj}var bet_wallets=betMobile.Wallets=Wallets();function Wallets(){var key=bet_cookies.getCookie("s")+"_"+bet_cookies.getCookie("language")+"_wallet_list";return{init:function(){this.list(!0)},fetchWallet:function(id,callback,selector){var _self=this,resource="/user/wallet/"+id;_.isEmpty(selector)&&(selector="balance-"+id);bet_send(resource,"GET",{selector:selector},function(response){_self.updateWallet(response.ResponseData),amplify.publish("update-wallet-item",response.ResponseData),"function"==typeof callback&&callback(response)})},fetchWallets:function(wallets){var _self=this;_.isEmpty(wallets)&&(wallets=_self.products);_.forEach(wallets,function(wallet){_self.fetchWallet(wallet.Id,function(response){})})},list:function(isSelectOrder,reload){var _self=this,walletList=amplify.store(key),isReload=!_.isEmpty(reload)&&reload;if(_.isEmpty(walletList)||isReload){var resource="/user/wallets/list?isSelectOrder="+(isSelectOrder=!_.isEmpty(isSelectOrder)&&isSelectOrder);bet_send(resource,"GET",{selector:""},function(response){_self.products=response.ResponseData,amplify.store(key,response.ResponseData,{expires:9e5}),amplify.publish("update-wallet-products",response.ResponseData)})}else _self.products=walletList,amplify.publish("update-wallet-products",walletList)},display:function(wallets,template,callback){var wallets=_.filter(wallets,function(data){return!_.isEqual(data.Id,0)});switch(template){case"WalletBallance":var items=_.sortBy(wallets,function(wallet){return wallet.SortOrder.DropList});bet_templates.apply("WalletBallance",function(template){var balance=_.template(template),walletbalance=balance({wallets:wallets});_.isEmpty($(".wallet-balance .balances").html())?$(".wallet-balance").append(walletbalance):$(".wallet-balance .balances").replaceWith(walletbalance)});break;case"WalletGroup":var items=_.sortBy(wallets,function(wallet){return wallet.SortOrder.TabList});bet_templates.apply("WalletGroup",function(template){var group=_.template(template),walletgroup=group({wallets:items});_.isEmpty($(".wallets .wallet-group").html())?$(".wallets").append(walletgroup):$(".wallets .wallet-group").replaceWith(walletgroup)})}},displayMainWallet:function(data,sel){var _self=this;selector="."+sel,wallet=_.isEmpty(data)?getWallet(0):data,bet_templates.apply("MainWallet",function(template){var main=_.template(template),mainwallet=main(wallet);_.isEmpty($(selector+" .wallet-main").html())?$(selector).prepend(mainwallet):$(selector+" .wallet-main").replaceWith(mainwallet),_self.fetchWallet(0,function(response){},sel)})},getWallet:getWallet,showMainWallet:function(sel){var _self=this;selector="."+sel,wallet=_.first(_self.products),bet_templates.apply("MainWallet",function(template){var main=_.template(template),mainwallet=main(wallet);_.isEmpty($(selector+" .wallet-main").html())?$(selector).prepend(mainwallet):$(selector+" .wallet-main").replaceWith(mainwallet),_self.fetchWallet(0,function(response){},sel)})},updateWallet:function(data){var walletIndex=_.findIndex(this.wallets,function(wallet){return wallet.Id==data.Id});-1!=walletIndex?this.wallets[walletIndex]=data:this.wallets.push(data);$(".wallet-value.balance-"+data.Id).html(data.Balance),$(".wallet-value.select-"+data.Id).html(_.join([data.CurrencyLabel,data.Balance]," ")),$(".wallet-title-"+data.Id).html(data.Name)},products:[],wallets:[]};function getWallet(id){return _.find(this.wallets,function(wallet){return wallet.Id==id})}}var bet_rewards=betMobile.Rewards=Rewards();function Rewards(){return{init:function(options){getPoints({selector:_.isUndefined(options)?"rewards-value":options.selector})},fetch:getPoints};function getPoints(selector,callback){bet_send("/user/rewards","GET",selector,function(response){_.isUndefined(response.ResponseData)?console.log("Unable to fetch rewards."):(amplify.publish("rewardsPointLoaded",response.ResponseData),"function"==typeof callback&&callback(response.ResponseData))})}}var bet_fundtransfer=betMobile.FundTransfer=FundTransfer();function FundTransfer(){var wallets=[];return{init:function(){amplify.subscribe("update-wallet-products",onWalletsLoaded),bet_wallets.init(),bet_validator.initiateValidator("#form1"),$(".wallet-balance").on("show.bs.collapse",function(){$("#showBalance").text($.i18n("BUTTON_HIDE_BALANCE"))}),$(".wallet-balance").on("hide.bs.collapse",function(){$("#showBalance").text($.i18n("BUTTON_SHOW_BALANCE"))}),$('select[id$="drpTransferFrom"]').change(function(){var selectedValue;selectedValue=this.value,$('select[id$="drpTransferTo"] option').each(function(){_.isEqual($(this).val(),"-1")||(_.isEqual($(this).val(),selectedValue)?($(this).hide(),$('select[id$="drpTransferTo"]').val("-1").change()):$(this).show())}),_.isEqual(selectedValue,"0")?$(".promocode").show():($('[id$="txtPromoCode"]').val(""),$(".promocode").hide())}),$('select[id$="drpTransferTo"]').change(function(){var option=$("option:selected",this).attr("balance");$(this).attr("balance",option)}),$("#btnSwap").click(function(){swap()}),template=_.template($("script#BonusPickerTemplate").html()),bet_send("/payments/bonuscodes","GET","",function(response){_.isEqual(response.ResponseCode,1)&&($("#full-modal div.modal-content").html(template({data:response.ResponseData})),$("#full-modal div.modal-content").i18n())});var template},swap:swap,create:function(data,callback){bet_send("/payments/transfer","POST",data,function(response){switch(response.ResponseCode){case 1:_.isArray(response.ResponseMessage)?betMobile.Growl.shout(betMobile.Growl.bulletedList(response.ResponseMessage),function(){"function"==typeof callback?callback():window.location.reload()}):betMobile.Growl.shout(response.ResponseMessage,function(){"function"==typeof callback?callback():window.location.reload()});break;default:_.isArray(response.ResponseMessage)?betMobile.Growl.shout(betMobile.Growl.bulletedList(response.ResponseMessage)):betMobile.Growl.shout(response.ResponseMessage)}})},bonuspicker:{show:function(){$("#full-modal div.modal-header.close").show(),$("#full-modal").modal("show")},setPromoCode:function(code,walletId){$('[id$="txtPromoCode"]').val(code),$('select[id$="drpTransferTo"]').val(walletId).change(),$("#full-modal").modal("hide")}}};function swap(){var valTransferFrom=$('select[id$="drpTransferFrom"]').val();$('select[id$="drpTransferFrom"]').val($('select[id$="drpTransferTo"]').val()).change(),$('select[id$="drpTransferTo"]').val(valTransferFrom).change()}function onWalletsLoaded(data){wallets=data,$('select[id$="drpTransferFrom"]').find("option").remove(),$('select[id$="drpTransferFrom"]').append($("<option></option>").attr("data-i18n","LABEL_SELECT_DEFAULT").attr("value","-1").text($.i18n("LABEL_SELECT_DEFAULT"))),_.forOwn(wallets,function(data){$('select[id$="drpTransferFrom"]').append($("<option>").text(data.Name).attr("value",data.Id).attr("balance",stringToNumber(data.Balance)))}),$('select[id$="drpTransferTo"]').find("option").remove(),$('select[id$="drpTransferTo"]').append($("<option></option>").attr("data-i18n","LABEL_SELECT_DEFAULT").attr("value","-1").text($.i18n("LABEL_SELECT_DEFAULT"))),_.forOwn(wallets,function(data){$('select[id$="drpTransferTo"]').append($("<option>").text(data.Name).attr("value",data.Id).attr("balance",stringToNumber(data.Balance)))});var transferto=getQueryStringValue("transferto");_.isEmpty(transferto)||($('select[id$="drpTransferFrom"]').val("0").change(),$('select[id$="drpTransferTo"]').val(transferto).change())}}function Sidebar(userSvc,safetySvc,rewardsSvc,transferSvc,walletSvc){var sb={};return sb.sidebarMain=$("section.right-sidebar"),sb.sidebarForms=$("<div>").addClass("sidebar-forms"),sb.wallets=[],sb.fromWallet={},sb.toWallet={},sb.mainWallet={},sb.hasLoaded=!1,sb.captchaKey="c4ca4238a0b923820dcc509a6f75849b",sb.init=function(loginSvc){var _self=this;sb.hasLoaded=!0;userSvc.get();if(amplify.subscribe("update-wallet-item",function(data){data.Id==_self.mainWallet.Id&&(_self.mainWallet=_.clone(data),$("#wallet-dropdown b").html(_self.mainWallet.Name),$("#wallet-dropdown h4").html(_self.mainWallet.Balance),$("#wallet-dropdown p").html(_self.mainWallet.CurrencyLabel))}),userSvc.isLoggedIn()){_self.sidebarMain.append(_self.sidebarForms);var safetyData=amplify.store(safetySvc.cacheKey);_.isEmpty(safetyData)?safetySvc.fetch(function(){_self.showAvatar(),_self.applySafety()}):(_self.showAvatar(),_self.applySafety())}else _self.displayLogin(loginSvc)},sb.showAvatar=function(){var userData=userSvc.get(),safetyData=amplify.store(safetySvc.cacheKey),avatarHtml=_.template($("script#sidebarAvatar").html())({data:userData,safety:safetyData,isVIP:_.includes(safetySvc.vipList,safetyData.RiskLevel.Value),level:safetySvc.riskLevel(safetyData.RiskLevel.Value)});this.sidebarMain.find(".avatar-holder").html(avatarHtml),this.sidebarMain.i18n()},sb.applySafety=function(){userSvc.get();var safetyData=amplify.store(safetySvc.cacheKey),accountHtml=_.template($("script#sidebarAccount").html())({data:safetyData});this.sidebarMain.find(".safety-holder").html(accountHtml).i18n(),this.sidebarMain.find(".account-step").popover({html:!0,content:function(){return $(this).is("#account-profile")?$("#account-profile-content").html():$(this).is("#account-email")?$("#account-email-content").html():$(this).is("#account-phone")?$("#account-phone-content").html():$(this).is("#account-card")?$("#account-card-content").html():void 0},placement:"top",trigger:"focus",viewport:{selector:"body",padding:10}}).i18n()},sb.showBalances=function(items){var userData=userSvc.get(),walletTemplate=_.template($("script#sidebarWallet").html()),data=_.sortBy(items,function(wallet){return wallet.SortOrder.DropList});this.mainWallet=_.find(data,function(wallet){return 0==wallet.Id}),this.mainWallet.Balance=userData.Balance.Balance;var walletHtml=walletTemplate({wallets:data});this.sidebarMain.find(".balance-holder").html(walletHtml).i18n(),this.fetchRewards()},sb.fetchRewards=function(){var userData=userSvc.get();rewardsSvc.fetch({selector:""},function(data){_.isEmpty(data)||$("#sidebar-rewards #rewards-points").html(data)});var currentDomain=_.clone(location.origin),rewardsUrl=_.replace(currentDomain,"//m.","//mrewards.")+_constants.REWARDS_LINK_SUFFIX+"/?lang="+bet_cookies.getCookie("language")+"&token="+userData.AppKey;$("#sidebar-rewards").attr("href",rewardsUrl)},sb.changeSidebarWallet=function(id,type){var wallet={},product=_.find(bet_wallets.products,function(wallet){return wallet.Id==id});if(_.isEmpty(product))wallet=product;else{var balance=bet_wallets.getWallet(product.Id);wallet=_.isEmpty(balance)?product:balance}switch(type){case"from":$("#current-from-wallet").html(wallet.Name),this.fromWallet=_.clone(wallet);break;case"to":$("#current-to-wallet").html(wallet.Name),this.toWallet=_.clone(wallet);break;case"main":default:this.mainWallet=_.clone(wallet),$("#wallet-dropdown b").html(wallet.Name),$("#wallet-dropdown h4").html(wallet.Balance),$("#wallet-dropdown p").html(wallet.CurrencyLabel)}},sb.attachTransfer=function(data){var _self=this;if(_constants.MAINTENANCE.FundTransfer||_constants.MAINTENANCE.Deposit)return $("#deposit-button").addClass("hide"),void _self.applyMaintenance();var transferHtml=_.template($("script#sidebarTransfer").html())({wallets:data});_self.sidebarMain.find(".transfer-holder").html(transferHtml).i18n(),$("#deposit-button").attr("href",_constants.DEPOSIT_URL),_self.sidebarMain.i18n(),_self.changeSidebarWallet(_.head(data).Id,"from"),_self.changeSidebarWallet(_.nth(data,1).Id,"to"),bet_validator.initiateValidator("#sidebar-transfer"),$("#sidebar-transfer").validator().on("submit",function(e){if(!e.isDefaultPrevented()){e.preventDefault();var data={TransferFrom:_self.fromWallet.Id,TransferTo:_self.toWallet.Id,TransferAmount:$('input[id$="quickTransferAmount"]').autoNumeric("get"),PromoCode:""};transferSvc.create(data,function(){$("#sidebar-transfer")[0].reset(),bet_wallets.fetchWallet(_self.fromWallet.Id,function(response){}),bet_wallets.fetchWallet(_self.toWallet.Id,function(response){})})}})},sb.displayLogin=function(loginSvc){var _self=this,selector=".login-container",templateData={};templateData.vCode=bet_cookies.getCookie(_self.captchaKey),templateData.assetsPath="/_static/v2/",bet_templates.apply("User_Login",function(template){var tplHtml=_.template(template)(templateData);_self.sidebarMain.append(tplHtml),_self.sidebarMain.i18n(),loginSvc.init(),$(selector+" #form1 input").on("keypress",function(e){13==e.which&&loginSvc.attachPasswordValidation()}),$(selector+" #form1 input").on("click",function(e){loginSvc.attachPasswordValidation()}),$(selector+" #form1").validator().on("submit",function(e){if(!e.isDefaultPrevented()){e.preventDefault(),loginSvc.type="palazzo"==loginSvc.type?"default":loginSvc.type;var data={Username:$(this).find('[id$="txtUsername"]').val(),Password:$(this).find('[id$="txtPassword"]').val(),CaptchCode:_.toLower($(this).find('[id$="txtCaptcha"]').val()),VerificationCode:$(this).find('[id$="vCode"]').val()};loginSvc.login(data)}})})},sb.getWalletTemplate=function(data){return _.template($("script#sidebarWalletList").html())(data)},sb.applyMaintenance=function(){if(_constants.MAINTENANCE.Deposit||_constants.MAINTENANCE.FundTransfer){var maintenanceHtml=_.template($("script#sidebarMaintenance").html())({label:"Enhancement",message:"Enhancement_Message"});this.sidebarMain.find(".transfer-holder").html(maintenanceHtml).i18n()}},sb}window.bet_sidebar=Sidebar,window.betMobile.AccountSafety=AccountSafety();var bet_accountsafety=window.betMobile.AccountSafety;function AccountSafety(){var accountsafety={},emailKey=window.User.token+"_verification_email",contactKey=window.User.token+"_verification_contact",cacheExpire={expires:864e5},cacheKey=_.join([window.User.token,bet_cookies.getCookie("language"),"_account_safety"],"_"),verifyData={MethodName:"",LastRequested:{},Email:"",CapCount:0,Contact:""};return accountsafety.cacheExpired=!1,accountsafety.cacheKey=cacheKey,accountsafety.vipList=["VIPB","VIPD","VIPG","VIPP"],accountsafety.init=function(){this.display(this.display)},accountsafety.riskLevel=function(category){switch(category){case"VIPB":return"Blue";case"VIPD":return"Diamond";case"VIPP":return"Platinum";case"VIPG":return"Gold";default:return"Default"}},accountsafety.fetch=function(callback){bet_send("/user/safety","GET","",function(response){var d=response.ResponseData;amplify.store(cacheKey,d,cacheExpire),"function"==typeof callback&&callback()})},accountsafety.display=function(){var data=amplify.store(cacheKey);if(_.isEmpty(data)||this.cacheExpired)this.fetch(this.display);else{var template=_.template($("script#AccountSafetyTemplate").html());$("#accountsafety-placeholder").html(template({data:data,IsVip:_.includes(this.vipList,data.RiskLevel.Value)})),$(".account-step").popover({html:!0,content:function(){return $(this).is("#account-profile")?$("#account-profile-content").html():$(this).is("#account-email")?$("#account-email-content").html():$(this).is("#account-phone")?$("#account-phone-content").html():$(this).is("#account-card")?$("#account-card-content").html():void 0},placement:"top",trigger:"focus",viewport:{selector:"body",padding:10}}),$("#accountsafety-placeholder").i18n()}},accountsafety.resendCode=function(method){bet_validator.initiateValidator($("#form1"),{});var key="EmailVerification"==method.Name?emailKey:contactKey,cache="EmailVerification"==method.Name?window.User.storageExpiration:cacheExpire;verifyData=amplify.store(key),_.isEmpty(verifyData)&&(verifyData={MethodName:method.Name,LastRequested:{},Email:"",CapCount:0,Contact:""}),bet_send("/user/safety/verify/send","POST",verifyData,function(response){switch("EmailVerification"==(verifyData=response.ResponseData).MethodName?$('input[id$="txtEmail"]').val(verifyData.Email):$('input[id$="txtContact"]').val(verifyData.Contact),response.ResponseCode){case 1:amplify.store(key,verifyData,cache),betMobile.Growl.shout(response.ResponseMessage);break;default:betMobile.Growl.shout(response.ResponseMessage)}}),$(".container").i18n()},accountsafety.verifyCode=function(method){var key="EmailVerification"==method.Name?emailKey:contactKey,cache="EmailVerification"==method.Name?window.User.storageExpiration:cacheExpire;verifyData=amplify.store(key),_.isEmpty(verifyData)?verifyData={LastRequested:"",MethodName:method.Name,Code:$('input[id$="txtVerificationCode"]').val(),CapCount:0}:verifyData.Code=$('input[id$="txtVerificationCode"]').val(),bet_send("/user/safety/verify","POST",verifyData,function(response){switch(response.ResponseCode){case 1:amplify.store(key,verifyData,cache),betMobile.Growl.shout(response.ResponseMessage,function(){window.location.href=_constants.ACCOUNT_URL});break;default:betMobile.Growl.shout(response.ResponseMessage)}}),$(".container").i18n()},accountsafety}var bet_login=betMobile.Login=Login();function Login(){var counter=0,login={};function onCheckFreeRounds(data){var url=_.isEmpty(bet_cookies.getCookie("IsApp"))?_constants.DASHBOARD_URL:_constants.FUNDS_URL;if(_.isEmpty(data)){if(_.isEmpty(getQueryStringValue("redirect")))if(_.isEmpty(getQueryStringValue("url")))url=_constants.DASHBOARD_URL;else{var hasParam=-1!=_.indexOf(getQueryStringValue("url"),"?");url=getQueryStringValue("url")+(hasParam?"&":"?")+"s="+bet_cookies.getCookie("s")}else url=getQueryStringValue("redirect");window.location.href=url}else{var freeroundsImage="/_static/images/v2/freerounds/Popup-free-round-"+bet_getShortLanguage(bet_cookies.getCookie("language"))+".jpg";$("#btnClaimNow").attr("href",data),$("#freerounds-modal .freerounds-img").attr("src",freeroundsImage),$("#freerounds-modal").on("hidden.bs.modal",function(){window.location.href=url}),$("#freerounds-modal").modal("show")}}return login.type="default",login.init=function(options,isSelection){if(bet_user.isLoggedIn()&&_.isEmpty(getQueryStringValue("code"))){var url="";url=_.isEmpty(getQueryStringValue("redirect"))?_.isEmpty(getQueryStringValue("url"))?_.isEmpty(bet_cookies.getCookie("IsApp"))?_constants.DASHBOARD_URL:_constants.FUNDS_URL:getQueryStringValue("url")+"?s="+bet_cookies.getCookie("s"):getQueryStringValue("redirect"),window.location.href=url}else{var params=bet_queryString();if(_.isEmpty(params.username)||_.isEmpty(params.code))login.getRedirectUrl();else{var data={Username:params.username,Password:params.code,Vendor:this.type};this.login(data)}bet_validator.initiateValidator("#form1"),$(".reload-captcha").click(function(){$("#imgCaptcha").attr("src","/Users/Captcha.aspx?t="+(new Date).getTime())}),login.hideCaptcha(),$("#btn-show-pass span").click(function(){$(this).hasClass("icon-eye-slashed")?($("#txtPassword").attr("type","text"),$(this).removeClass("icon-eye-slashed").addClass("icon-eye")):($("#txtPassword").attr("type","password"),$(this).removeClass("icon-eye").addClass("icon-eye-slashed")),$("#txtPassword").focus()})}},login.getRedirectUrl=function(){var redirect=getQueryStringValue("redirect"),token=getQueryStringValue("token");if(_.isEmpty(token))_.isEmpty(redirect)?login.getGPIUrl():this.show();else{if(!isBase64(token))return void this.show();data={encryptedToken:token},login.autologin(data)}},login.getGPIUrl=function(){var url=getQueryStringValue("url"),sessionid=siteCookie.getCookie("s");if(!_.isEmpty(url)){var newUrl=new URL(decodeURIComponent(url));if(!_.isEmpty(sessionid)){newUrl.searchParams.forEach(function(value,key){-1!=_.indexOf(["domainlink","domain"],key)&&newUrl.searchParams.set(key,getDomainName())}),newUrl.searchParams.set("s",sessionid),newUrl.searchParams.set("token",sessionid);var urlArr=newUrl.href.split("?"),redirect=(_.isEmpty(urlArr[0])?newUrl.href:urlArr[0])+"?"+newUrl.searchParams.toString();return void(window.location=redirect)}}this.show()},login.showCaptcha=function(){$(".captcha").show(),$('input[id$="txtCaptcha"]').attr({required:"","data-require":""}),$("#form1").validator("update")},login.hideCaptcha=function(){$(".captcha").hide(),$('input[id$="txtCaptcha"]').removeAttr("required data-require"),$("#form1").validator("update")},login.submitLogin=function(data){var _self=this,loginResource="/user/app/login";"palazzo"==_self.type&&(loginResource="/user/applogin"),bet_send(loginResource,"POST",data,function(response){switch(response.ResponseCode){case 1:var userData=response.ResponseData;if(bet_user.set(userData),1==userData.ResetPassword)betMobile.PiwikManager.trackEvent({category:"Login",action:"login but need to change password"}),login.changePassword();else{if(betMobile.PiwikManager.trackEvent({category:"Login",action:"login successful"}),"palazzo"==_self.type)return void(location.href=_constants.FUNDS_URL);login.getGPIUrl(),amplify.subscribe("checkFreeRounds",onCheckFreeRounds),bet_products.checkFreeRounds()}break;default:betMobile.PiwikManager.trackEvent({category:"Login",action:"login unsuccessful"}),counter+=1,_.isArray(response.ResponseMessage)?betMobile.Growl.shout(betMobile.Growl.bulletedList(response.ResponseMessage)):betMobile.Growl.shout(response.ResponseMessage),counter>=3&&login.showCaptcha(),counter<=1&&_self.show()}})},login.login=function(data){var _self=this;data.HasVCode=counter>=3,data.HasVCode?bet_local_send("/Users/CheckCaptcha.ashx","POST",{vCode:data.CaptchCode},function(response){"Fail"!=response?(data.VerificationCode=response,_self.submitLogin(data)):(betMobile.Growl.shout($.i18n("Reg_InvalidVCode")),_self.show())}):_self.submitLogin(data)},login.changePassword=function(data){var redirect=getQueryStringValue("redirect");redirect=_.isEmpty(redirect)?"/Users/Accounts/ChangePassword.aspx":"/Users/Accounts/ChangePassword.aspx?redirect="+redirect,window.location.href=redirect},login.autologin=function(data){var _self=this;bet_send("/user/autologin","Get",data,function(response){switch(response.ResponseCode){case 1:var userData=response.ResponseData;bet_user.set(userData);var redirect=getQueryStringValue("redirect");_.isEmpty(redirect)?window.location.href=_constants.FUNDS_URL:window.location.href=redirect;break;default:_.isArray(response.ResponseMessage)?betMobile.Growl.shout(betMobile.Growl.bulletedList(response.ResponseMessage)):betMobile.Growl.shout(response.ResponseMessage),_self.show()}})},login.show=function(){$("div.login").removeClass("hide")},login.attachPasswordValidation=function(){var attr=$('[id$="txtPassword"]').attr("required");void 0!==attr&&!1!==attr||($('[id$="txtPassword"]').attr("required","").attr("data-require","").off("focus"),$("#form1").validator("update"))},login}function Gateway(paymentSvc){function offlineSend(self,form,data,successCallback,completeCallback){var _self=self;_.isUndefined(successCallback)?_self.send("/payments/"+_self.methodId,"POST",data,function(response){switch(response.ResponseCode){case 1:betMobile.Growl.shout("<p>"+response.ResponseMessage+"</p> <p>"+$.i18n("LABEL_TRANSACTION_ID")+": "+response.ResponseData.TransactionId+"</p>",function(){_self.formReset(form)});break;default:_.isArray(response.ResponseMessage)?betMobile.Growl.shout(betMobile.Growl.bulletedList(response.ResponseMessage)):betMobile.Growl.shout(response.ResponseMessage)}},function(){}):_self.send("/payments/"+_self.methodId,"POST",data,successCallback,completeCallback)}this.switchLineExpiration={expires:3e5},this.methodId,this.send=function(resource,method,data,success,complete){bet_send(resource,method,data,success,complete)},this.deposit=function(data,successCallback,completeCallback){var _self=this;_.includes(paymentSvc.AutoRouteIds,_self.methodId)?_self.autoRouteSend(data,function(methodId,data){_self.send("/payments/"+methodId,"POST",data,successCallback,completeCallback)},""):_self.send("/payments/"+_self.methodId,"POST",data,successCallback,completeCallback)},this.autoRouteSend=function(data,successCallback,completeCallback){var _self=this,prevMethodIds=amplify.store(betMobile.Keys.switchLineSettings);data.Id=prevMethodIds,_self.send("/payments/autoroute/"+_self.methodId,"POST",data,function(response){switch(response.ResponseCode){case 1:var id=void 0;_.isUndefined(response.ResponseData.Bank)||(data.Bank=response.ResponseData.Bank),_.isUndefined(response.ResponseData.MethodId)||(id=response.ResponseData.MethodId),_.isUndefined(response.ResponseData.AccountId)||(id=response.ResponseData.AccountId),prevMethodIds&&!response.ResponseData.ResetPreviousList?amplify.store(betMobile.Keys.switchLineSettings,prevMethodIds+","+id,_self.switchLineExpiration):amplify.store(betMobile.Keys.switchLineSettings,id,_self.switchLineExpiration),successCallback(id,data);break;default:_.isArray(response.ResponseMessage)?betMobile.Growl.shout(betMobile.Growl.bulletedList(response.ResponseMessage),_self.shoutCallback):betMobile.Growl.shout(response.ResponseMessage,_self.shoutCallback)}},completeCallback)},this.offlineDeposit=function(form,data,successCallback,completeCallback){var _self=this;_.includes(paymentSvc.AutoRouteIds,_self.methodId)?_self.autoRouteSend(data,function(gatewayId,data){_self.methodId=gatewayId,offlineSend(_self,form,data,successCallback,completeCallback)},""):!_.isUndefined(data.RouteAccount)&&_.isEqual(data.RouteAccount,!0)?_self.autoRouteSend(data,function(accountId,data){data.AccountNumber=accountId,offlineSend(_self,form,data,successCallback,completeCallback)},""):offlineSend(_self,form,data,successCallback,completeCallback)},this.withdraw=function(data,successCallback,completeCallback){_.isUndefined(successCallback)?this.send("/payments/"+this.methodId,"POST",data,function(response){switch(response.ResponseCode){case 1:betMobile.Growl.shout("<p>"+response.ResponseMessage+"</p> <p>"+$.i18n("LABEL_TRANSACTION_ID")+": "+response.ResponseData.TransactionId+"</p>",function(){window.location="/Funds/Withdrawal/"});break;default:_.isArray(response.ResponseMessage)?betMobile.Growl.shout(betMobile.Growl.bulletedList(response.ResponseMessage)):betMobile.Growl.shout(response.ResponseMessage)}},function(){}):this.send("/payments/"+this.methodId,"POST",data,successCallback,completeCallback)},this.getUrlVars=function(){for(var hash,vars=[],hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<hashes.length;i++)hash=hashes[i].split("="),vars.push(hash[0]),vars[hash[0]]=decodeURIComponent(_.isEmpty(hash[1])?hash[1]:hash[1].replace(/\+/g,"%20"));return vars},this.shoutCallback=function(){window.close()},this.changeRoute=function(){if(history.pushState){var newurl=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.pushState({path:newurl},"",newurl)}},this.formReset=function(form){_.isUndefined(form)||_.first(form).reset(),_.forEach($("[data-date-box]"),function(item,index){$(item).datebox("setTheDate",new Date)})}}window.betMobile.Gateway=Gateway;